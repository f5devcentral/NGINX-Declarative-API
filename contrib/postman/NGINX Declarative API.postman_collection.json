{
	"info": {
		"_postman_id": "d80ee41f-6797-4bf0-be08-043e85043cb3",
		"name": "NGINX Declarative API",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "1667416"
	},
	"item": [
		{
			"name": "v1 - deprecated",
			"item": [
				{
					"name": "Standard",
					"item": [
						{
							"name": "Basic - LB",
							"item": [
								{
									"name": "Basic - LB - plaintext output",
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"plaintext\"\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"udp\"\n                    },\n                    \"upstream\": \"l4_upstream\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"urimatch\": \"prefix\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true\n                            }\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v1/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v1",
												"config"
											]
										}
									},
									"response": []
								},
								{
									"name": "Basic - LB - json b64 encoded output",
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"json\"\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"udp\"\n                    },\n                    \"upstream\": \"l4_upstream\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"urimatch\": \"prefix\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true\n                            }\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v1/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v1",
												"config"
											]
										}
									},
									"response": []
								},
								{
									"name": "Basic - LB - ConfigMap output",
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"configmap\",\n        \"configmap\": {\n            \"name\": \"nginx.test\",\n            \"filename\": \"testservice.conf\",\n            \"namespace\": \"test-namespace\"\n        }\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"udp\"\n                    },\n                    \"upstream\": \"l4_upstream\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"urimatch\": \"prefix\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true\n                            }\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v1/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v1",
												"config"
											]
										}
									},
									"response": []
								},
								{
									"name": "Basic - LB - HTTP output",
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"http\",\n        \"http\": {\n            \"url\": \"http://192.168.1.18:8080/path/service\"\n        }\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"udp\"\n                    },\n                    \"upstream\": \"l4_upstream\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"urimatch\": \"prefix\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true\n                            }\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v1/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v1",
												"config"
											]
										}
									},
									"response": []
								},
								{
									"name": "Basic - LB - NMS output",
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\"\n        }\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"udp\"\n                    },\n                    \"upstream\": \"l4_upstream\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"urimatch\": \"prefix\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true\n                            }\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v1/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v1",
												"config"
											]
										}
									},
									"response": []
								}
							]
						},
						{
							"name": "Advanced",
							"item": [
								{
									"name": "Advanced LB - plaintext output",
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"plaintext\"\n    },\n   \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"tcp\",\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"upstream\": \"l4_upstream\",\n                    \"snippet\": \"IyBUaGlzIGlzIGEgbDQgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/test\",\n                            \"urimatch\": \"exact\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true,\n                                \"uri\": \"/healthcheck\",\n                                \"interval\": 5,\n                                \"fails\": 3,\n                                \"passes\": 2\n                            },\n                            \"rate_limit\": {\n                                \"profile\": \"test_ratelimit\",\n                                \"httpcode\": 429,\n                                \"burst\": 10,\n                                \"delay\": 3\n                            },\n                            \"app_protect\": {\n                                \"enabled\": true,\n                                \"policy\": \"test_policy\",\n                                \"log\": {\n                                    \"profile_name\": \"okta\",\n                                    \"enabled\": true,\n                                    \"destination\": \"192.168.1.5:514\"\n                                }\n                            },\n                            \"snippet\": \"IyBUaGlzIGlzIGEgbG9jYXRpb24gc25pcHBldCBjb21tZW50Cg==\"\n                        }\n                    ],\n                    \"app_protect\": {\n                        \"enabled\": true,\n                        \"policy\": \"test_policy\",\n                        \"log\": {\n                            \"profile_name\": \"default\",\n                            \"enabled\": true,\n                            \"destination\": \"192.168.1.5:514\"\n                        }\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgc2VydmVyIHNuaXBwZXQgY29tbWVudAo=\"\n                },\n                {\n                    \"names\": [\n                        \"server_443\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:443\",\n                        \"http2\": true,\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"upstream\": \"http://test_upstream\"\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\",\n                            \"weight\": 5,\n                            \"max_fails\": 2,\n                            \"fail_timeout\": \"30s\",\n                            \"max_conns\": 3,\n                            \"slow_start\": \"30s\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\",\n                            \"backup\": true\n                        }\n                    ],\n                    \"sticky\": {\n                        \"cookie\": \"cookie_name\",\n                        \"expires\": \"1h\",\n                        \"domain\": \".testserver\",\n                        \"path\": \"/\"\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"rate_limit\": [\n                {\n                    \"name\": \"test_ratelimit\",\n                    \"key\": \"$binary_remote_addr\",\n                    \"size\": \"10m\",\n                    \"rate\": \"1r/s\"\n                }\n            ],\n            \"maps\": [\n                {\n                    \"match\": \"$host$request_uri\",\n                    \"variable\": \"$backend\",\n                    \"entries\": [\n                        {\n                            \"key\": \"www.test.lab/app1/\",\n                            \"keymatch\": \"iregex\",\n                            \"value\": \"upstream_1\"\n                        },\n                        {\n                            \"key\": \"(.*).test.lab/app2/\",\n                            \"keymatch\": \"regex\",\n                            \"value\": \"upstream_2\"\n                        }\n                    ]\n                }\n            ],\n            \"nginx_plus_api\": {\n                \"write\": true,\n                \"listen\": \"127.0.0.1:8080\",\n                \"allow_acl\": \"0.0.0.0/0\"\n            },\n            \"snippet\": \"IyBUaGlzIGlzIGEgSFRUUCBzbmlwcGV0IGNvbW1lbnQK\"\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v1/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v1",
												"config"
											]
										}
									},
									"response": []
								},
								{
									"name": "Advanced LB - json b64 encoded output",
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"json\"\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"tcp\",\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"upstream\": \"l4_upstream\",\n                    \"snippet\": \"IyBUaGlzIGlzIGEgbDQgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/test\",\n                            \"urimatch\": \"exact\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true,\n                                \"uri\": \"/healthcheck\",\n                                \"interval\": 5,\n                                \"fails\": 3,\n                                \"passes\": 2\n                            },\n                            \"rate_limit\": {\n                                \"profile\": \"test_ratelimit\",\n                                \"httpcode\": 429,\n                                \"burst\": 10,\n                                \"delay\": 3\n                            },\n                            \"app_protect\": {\n                                \"enabled\": true,\n                                \"policy\": \"test_policy\",\n                                \"log\": {\n                                    \"profile_name\": \"okta\",\n                                    \"enabled\": true,\n                                    \"destination\": \"192.168.1.5:514\"\n                                }\n                            },\n                            \"snippet\": \"IyBUaGlzIGlzIGEgbG9jYXRpb24gc25pcHBldCBjb21tZW50Cg==\"\n                        }\n                    ],\n                    \"app_protect\": {\n                        \"enabled\": true,\n                        \"policy\": \"test_policy\",\n                        \"log\": {\n                            \"profile_name\": \"default\",\n                            \"enabled\": true,\n                            \"destination\": \"192.168.1.5:514\"\n                        }\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgc2VydmVyIHNuaXBwZXQgY29tbWVudAo=\"\n                },\n                {\n                    \"names\": [\n                        \"server_443\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:443\",\n                        \"http2\": true,\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"upstream\": \"http://test_upstream\"\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\",\n                            \"weight\": 5,\n                            \"max_fails\": 2,\n                            \"fail_timeout\": \"30s\",\n                            \"max_conns\": 3,\n                            \"slow_start\": \"30s\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\",\n                            \"backup\": true\n                        }\n                    ],\n                    \"sticky\": {\n                        \"cookie\": \"cookie_name\",\n                        \"expires\": \"1h\",\n                        \"domain\": \".testserver\",\n                        \"path\": \"/\"\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"rate_limit\": [\n                {\n                    \"name\": \"test_ratelimit\",\n                    \"key\": \"$binary_remote_addr\",\n                    \"size\": \"10m\",\n                    \"rate\": \"1r/s\"\n                }\n            ],\n            \"maps\": [\n                {\n                    \"match\": \"$host$request_uri\",\n                    \"variable\": \"$backend\",\n                    \"entries\": [\n                        {\n                            \"key\": \"www.test.lab/app1/\",\n                            \"keymatch\": \"iregex\",\n                            \"value\": \"upstream_1\"\n                        },\n                        {\n                            \"key\": \"(.*).test.lab/app2/\",\n                            \"keymatch\": \"regex\",\n                            \"value\": \"upstream_2\"\n                        }\n                    ]\n                }\n            ],\n            \"nginx_plus_api\": {\n                \"write\": true,\n                \"listen\": \"127.0.0.1:8080\",\n                \"allow_acl\": \"0.0.0.0/0\"\n            },\n            \"snippet\": \"IyBUaGlzIGlzIGEgSFRUUCBzbmlwcGV0IGNvbW1lbnQK\"\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v1/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v1",
												"config"
											]
										}
									},
									"response": []
								},
								{
									"name": "Advanced LB - ConfigMap output",
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"configmap\",\n        \"configmap\": {\n            \"name\": \"nginx.test\",\n            \"filename\": \"testservice.conf\",\n            \"namespace\": \"test-namespace\"\n        }\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"tcp\",\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"upstream\": \"l4_upstream\",\n                    \"snippet\": \"IyBUaGlzIGlzIGEgbDQgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/test\",\n                            \"urimatch\": \"exact\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true,\n                                \"uri\": \"/healthcheck\",\n                                \"interval\": 5,\n                                \"fails\": 3,\n                                \"passes\": 2\n                            },\n                            \"rate_limit\": {\n                                \"profile\": \"test_ratelimit\",\n                                \"httpcode\": 429,\n                                \"burst\": 10,\n                                \"delay\": 3\n                            },\n                            \"app_protect\": {\n                                \"enabled\": true,\n                                \"policy\": \"test_policy\",\n                                \"log\": {\n                                    \"profile_name\": \"okta\",\n                                    \"enabled\": true,\n                                    \"destination\": \"192.168.1.5:514\"\n                                }\n                            },\n                            \"snippet\": \"IyBUaGlzIGlzIGEgbG9jYXRpb24gc25pcHBldCBjb21tZW50Cg==\"\n                        }\n                    ],\n                    \"app_protect\": {\n                        \"enabled\": true,\n                        \"policy\": \"test_policy\",\n                        \"log\": {\n                            \"profile_name\": \"default\",\n                            \"enabled\": true,\n                            \"destination\": \"192.168.1.5:514\"\n                        }\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgc2VydmVyIHNuaXBwZXQgY29tbWVudAo=\"\n                },\n                {\n                    \"names\": [\n                        \"server_443\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:443\",\n                        \"http2\": true,\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"upstream\": \"http://test_upstream\"\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\",\n                            \"weight\": 5,\n                            \"max_fails\": 2,\n                            \"fail_timeout\": \"30s\",\n                            \"max_conns\": 3,\n                            \"slow_start\": \"30s\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\",\n                            \"backup\": true\n                        }\n                    ],\n                    \"sticky\": {\n                        \"cookie\": \"cookie_name\",\n                        \"expires\": \"1h\",\n                        \"domain\": \".testserver\",\n                        \"path\": \"/\"\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"rate_limit\": [\n                {\n                    \"name\": \"test_ratelimit\",\n                    \"key\": \"$binary_remote_addr\",\n                    \"size\": \"10m\",\n                    \"rate\": \"1r/s\"\n                }\n            ],\n            \"maps\": [\n                {\n                    \"match\": \"$host$request_uri\",\n                    \"variable\": \"$backend\",\n                    \"entries\": [\n                        {\n                            \"key\": \"www.test.lab/app1/\",\n                            \"keymatch\": \"iregex\",\n                            \"value\": \"upstream_1\"\n                        },\n                        {\n                            \"key\": \"(.*).test.lab/app2/\",\n                            \"keymatch\": \"regex\",\n                            \"value\": \"upstream_2\"\n                        }\n                    ]\n                }\n            ],\n            \"nginx_plus_api\": {\n                \"write\": true,\n                \"listen\": \"127.0.0.1:8080\",\n                \"allow_acl\": \"0.0.0.0/0\"\n            },\n            \"snippet\": \"IyBUaGlzIGlzIGEgSFRUUCBzbmlwcGV0IGNvbW1lbnQK\"\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v1/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v1",
												"config"
											]
										}
									},
									"response": []
								},
								{
									"name": "Advanced LB - HTTP output",
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"http\",\n        \"http\": {\n            \"url\": \"http://192.168.1.18:8080/path/service\"\n        }\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"tcp\",\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"upstream\": \"l4_upstream\",\n                    \"snippet\": \"IyBUaGlzIGlzIGEgbDQgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/test\",\n                            \"urimatch\": \"exact\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true,\n                                \"uri\": \"/healthcheck\",\n                                \"interval\": 5,\n                                \"fails\": 3,\n                                \"passes\": 2\n                            },\n                            \"rate_limit\": {\n                                \"profile\": \"test_ratelimit\",\n                                \"httpcode\": 429,\n                                \"burst\": 10,\n                                \"delay\": 3\n                            },\n                            \"app_protect\": {\n                                \"enabled\": true,\n                                \"policy\": \"test_policy\",\n                                \"log\": {\n                                    \"profile_name\": \"okta\",\n                                    \"enabled\": true,\n                                    \"destination\": \"192.168.1.5:514\"\n                                }\n                            },\n                            \"snippet\": \"IyBUaGlzIGlzIGEgbG9jYXRpb24gc25pcHBldCBjb21tZW50Cg==\"\n                        }\n                    ],\n                    \"app_protect\": {\n                        \"enabled\": true,\n                        \"policy\": \"test_policy\",\n                        \"log\": {\n                            \"profile_name\": \"default\",\n                            \"enabled\": true,\n                            \"destination\": \"192.168.1.5:514\"\n                        }\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgc2VydmVyIHNuaXBwZXQgY29tbWVudAo=\"\n                },\n                {\n                    \"names\": [\n                        \"server_443\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:443\",\n                        \"http2\": true,\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"upstream\": \"http://test_upstream\"\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\",\n                            \"weight\": 5,\n                            \"max_fails\": 2,\n                            \"fail_timeout\": \"30s\",\n                            \"max_conns\": 3,\n                            \"slow_start\": \"30s\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\",\n                            \"backup\": true\n                        }\n                    ],\n                    \"sticky\": {\n                        \"cookie\": \"cookie_name\",\n                        \"expires\": \"1h\",\n                        \"domain\": \".testserver\",\n                        \"path\": \"/\"\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"rate_limit\": [\n                {\n                    \"name\": \"test_ratelimit\",\n                    \"key\": \"$binary_remote_addr\",\n                    \"size\": \"10m\",\n                    \"rate\": \"1r/s\"\n                }\n            ],\n            \"maps\": [\n                {\n                    \"match\": \"$host$request_uri\",\n                    \"variable\": \"$backend\",\n                    \"entries\": [\n                        {\n                            \"key\": \"www.test.lab/app1/\",\n                            \"keymatch\": \"iregex\",\n                            \"value\": \"upstream_1\"\n                        },\n                        {\n                            \"key\": \"(.*).test.lab/app2/\",\n                            \"keymatch\": \"regex\",\n                            \"value\": \"upstream_2\"\n                        }\n                    ]\n                }\n            ],\n            \"nginx_plus_api\": {\n                \"write\": true,\n                \"listen\": \"127.0.0.1:8080\",\n                \"allow_acl\": \"0.0.0.0/0\"\n            },\n            \"snippet\": \"IyBUaGlzIGlzIGEgSFRUUCBzbmlwcGV0IGNvbW1lbnQK\"\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v1/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v1",
												"config"
											]
										}
									},
									"response": []
								},
								{
									"name": "Advanced LB - NMS output",
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ],\n            \"certificates\": [\n                {\n                    \"type\": \"certificate\",\n                    \"name\": \"test_cert\",\n                    \"contents\": \"LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURSVENDQWkwQ0ZDQUVQMGU3U3A4MlFudE5xZFZOQXB3b1VOeDJNQTBHQ1NxR1NJYjNEUUVCQ3dVQU1GOHgKQ3pBSkJnTlZCQVlUQWtsVU1RNHdEQVlEVlFRSURBVk5hV3hoYmpFT01Bd0dBMVVFQnd3RlRXbHNZVzR4RlRBVApCZ05WQkFvTURGUmxjM1FnUTI5dGNHRnVlVEVaTUJjR0ExVUVBd3dRZEdWemRDNWpiMjF3WVc1NUxteGhZakFlCkZ3MHlNakExTVRZd056VTROVGRhRncwek1qQTFNVE13TnpVNE5UZGFNRjh4Q3pBSkJnTlZCQVlUQWtsVU1RNHcKREFZRFZRUUlEQVZOYVd4aGJqRU9NQXdHQTFVRUJ3d0ZUV2xzWVc0eEZUQVRCZ05WQkFvTURGUmxjM1FnUTI5dApjR0Z1ZVRFWk1CY0dBMVVFQXd3UWRHVnpkQzVqYjIxd1lXNTVMbXhoWWpDQ0FTSXdEUVlKS29aSWh2Y05BUUVCCkJRQURnZ0VQQURDQ0FRb0NnZ0VCQU1kaE02Yy8wdGpzT0lmTTlBMjNzQzJJK0dtZzd3NUJVbWRHQjlNc0pTa0IKZ3BQajZ6OTBHbFc3d0dRc25CQ0NNdmtwTzMzRVY0MWlPa0MzYnU3Ym50NXVkTi9kbEg0ZndnMzYrUWdpMnlTegpuVW5OUUNOQkRJTWNRcmFvcjlKdG5SWDAzYXVpY3ZSeEpGQ2lvL1gvNjNIMUFHZERKaFNWaUxRVjlqVjZhNlpNCjFMNDljUVVwekhSSlpPRGV1MnNIc2kxR0JuLzVnUStXSVR2RFp3SGQ0TjJGTkhmOXlJS1ZVQmkzVVRXQmpRRS8KVm15dkZVcmVBYnlldElzbEcvZVVVRkUyeFFhSzFXS2dMVUJrOXRnc3pycXFkNW11Y25ESmZ1elhkclArc1U2YQpkL1kvZVgxN3RKaG5xa25MZ25mVG91NTVLak9XdE93ZzN4OWt5amQ5bkFNQ0F3RUFBVEFOQmdrcWhraUc5dzBCCkFRc0ZBQU9DQVFFQXhyY1ppemR0L0wxWjVYQnE2R0djWTNSbzB0ZEdjdGZHZ0NsdjRvRzVTaE5BQmRhQTIvQ1YKVkE0TGtkb3JYV09hQWNGaWxpcFBlN0tGYVdIZ3EwZ3Q0eEt4LzlkOVZIcU5OY2srTlk0U3dHNDNrWjMyQWQ0QwpnUlowNEVhc1g3aG5wOG13alpLQ0FIWkpGK2krdC9sSFJOaEFDUzFGMHpyQmMrK3NUek5RK1dnTnVEbzN2OWkyCkNoZ1BRbEtBc3M0enM1NGE1RmJOTDJkWWJqNGRraXhJNDMwbU15dXg4SGJPUWFzVm9DVnpXcWtLa29RN25kdUgKRVBrWU0zRy9yVXRQZzhOVU1VVnlkdDFVbnlkb3c4cnhYYjZiQzYreTFQc2FrWHhSdW10ZFlnbDN3UWtJaitGUAoxVFgwSU9qKzdNZnR0cWdxemFhUm85V0s1Y3dpZTBlRGZBPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=\"\n                },\n                {\n                    \"type\": \"key\",\n                    \"name\": \"test_key\",\n                    \"contents\": \"LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2QUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktZd2dnU2lBZ0VBQW9JQkFRREhZVE9uUDlMWTdEaUgKelBRTnQ3QXRpUGhwb084T1FWSm5SZ2ZUTENVcEFZS1Q0K3MvZEJwVnU4QmtMSndRZ2pMNUtUdDl4RmVOWWpwQQp0Mjd1MjU3ZWJuVGYzWlIrSDhJTit2a0lJdHNrczUxSnpVQWpRUXlESEVLMnFLL1NiWjBWOU4ycm9uTDBjU1JRCm9xUDEvK3R4OVFCblF5WVVsWWkwRmZZMWVtdW1UTlMrUFhFRktjeDBTV1RnM3J0ckI3SXRSZ1ovK1lFUGxpRTcKdzJjQjNlRGRoVFIzL2NpQ2xWQVl0MUUxZ1kwQlAxWnNyeFZLM2dHOG5yU0xKUnYzbEZCUk5zVUdpdFZpb0MxQQpaUGJZTE02NnFuZVpybkp3eVg3czEzYXovckZPbW5mMlAzbDllN1NZWjZwSnk0SjMwNkx1ZVNvemxyVHNJTjhmClpNbzNmWndEQWdNQkFBRUNnZ0VBQUljZWhSMERVRlZaa1pudVhTdzJhRnVtM2pGYmcyMEhCNnZkdFgyQzA4ZUYKMUthYjhmQzJFN0kyUTc4ZUhNZ3JQZVZuUmlyclVsWHZieGI4S0dpWkg1b1pwOFgwR1oxU2FqREVOMEg5emUvcwpBSmY4c1daSzJEYkJ0ajRHTmlVazR6djNQeXMwYXVvWWx1TmtJbkpRbDZYNGVLWkIwVjBYbW54NEJpejNGVVVVCjliUlRlM09FTFYwNDVMUkt3eWRnOWFmQnZQcEZIQkdIcVBxRFptTHl6TWVNQjVHVmJBOEd2NVE4QS96WFdtcnoKSVE0QVlZeVU1dlZXKzBya0NRRVluR1c5QlNiYjB6d3prdVBKa1NRODhzOHV0T2RmMU5SOGZBVkdnazhXVHZXagpRVnlKVzV6Snc2SzlsS0w2Sy94VDlKOUZiWWpQWFZDd21jaDMweUpPWVFLQmdRRFI3NmpkRnhzMTZKMXR3U3Z0CkJBRWMzOVFCeTBPNmNQSWJLV1hYOE1FRDB1R0psYUJRSWE5WUdoS3lGYU5SRjJVTUJYWHVZVll1U2Rrb1lxMGwKNVBndmJoNVYxQjFVYVR5WG0rUTlBcWFsc3pSQW5TdXFKcytsVzJDaE5ISDRZQjlnKzQrZFlmcURuMWdTUlkzMgpvZVlrV05aQ0VHT0c0QUNtSTJXZU8wWklyd0tCZ1FEeklKTFRzQnJ3MldlMW8zOVd2RkpIaFF6RDRNU2ppSHovClRSZS9VV2ZEWlB1TzZmcXBHNXozbk9oWkVsUEJuRktKNTZQekZhemxJQ01xdmpoRHZtTkpmb1J3Y084cnVhOG8KenVzb2N0bk15UzFPOExSMDltZFlPdVhyY0RXamZ5QTdlZHBiWUVSTGYzQXJkL2VJZko0RTJ3SGI3bVhMRHgxbApRdnBjR3VsTzdRS0JnREgzK0ZwL2VIT1JaWDlOUGxaUTRLN3R1N21kbHdaV2dkbmpOYUY3WllXeWVRcFZlZTM0CnhwS1N5aVpuTGhOTUhUb0tSckt4cW1Da0pUTU9vYVhtWlFodERuMWhXb1hQOHFNbmNPRHdzNWUzR3RYU1V5VlIKelpUUE5pWElwT1A0aFIrQllRS1Y0cG5Yb0kvZ3pGU0szb3VDTmFWTjMxS29HSjl5eDJvdE02SnpBb0dBTDZicAp3RDNhK2V2U2pPSlB1Z05OS1NGbHdCcVV6K3lYZXo1ejhoYVZmTkdWRUl6QmlWV1ZMVjcrbHo2bFZlUTZ0VGJHCmhvVndEclIrMEFqYVpFU3pseHNLQURQU1hNS1hGeXQvSWIxby9OOU5WeFNNZWdRMWV6Q0lFZDQ3VlNFOGd3dSsKQlh6WHhlaGpadEdyblgrM1JRSmIyZXhlM1M3SU55bXFnbFR2OTMwQ2dZQkpsK2EvRHN0OE5iVlEvRHpuei93VgpPSDhKUENOS05EQm1WS3ZUVTNiQy9YQW8rQm42a2crbDZqczY5RkZlWHIvOGlHL25sTW9QQTlnT2Zxb3BmZ3AzClpTZFE1RlMrQk9kdFQrT2JacTBlcmxJSlk0dW9na3VEV2NpLzNaeExkYnNQUnhJS2c4MmdYRU9DN1dnb3VsUVQKV1doVUpSeGpJdGx6eUdseHhvb2lqQT09Ci0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K\"\n                },\n                {\n                    \"type\": \"chain\",\n                    \"name\": \"test_chain\",\n                    \"contents\": \"LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURSVENDQWkwQ0ZDQUVQMGU3U3A4MlFudE5xZFZOQXB3b1VOeDJNQTBHQ1NxR1NJYjNEUUVCQ3dVQU1GOHgKQ3pBSkJnTlZCQVlUQWtsVU1RNHdEQVlEVlFRSURBVk5hV3hoYmpFT01Bd0dBMVVFQnd3RlRXbHNZVzR4RlRBVApCZ05WQkFvTURGUmxjM1FnUTI5dGNHRnVlVEVaTUJjR0ExVUVBd3dRZEdWemRDNWpiMjF3WVc1NUxteGhZakFlCkZ3MHlNakExTVRZd056VTROVGRhRncwek1qQTFNVE13TnpVNE5UZGFNRjh4Q3pBSkJnTlZCQVlUQWtsVU1RNHcKREFZRFZRUUlEQVZOYVd4aGJqRU9NQXdHQTFVRUJ3d0ZUV2xzWVc0eEZUQVRCZ05WQkFvTURGUmxjM1FnUTI5dApjR0Z1ZVRFWk1CY0dBMVVFQXd3UWRHVnpkQzVqYjIxd1lXNTVMbXhoWWpDQ0FTSXdEUVlKS29aSWh2Y05BUUVCCkJRQURnZ0VQQURDQ0FRb0NnZ0VCQU1kaE02Yy8wdGpzT0lmTTlBMjNzQzJJK0dtZzd3NUJVbWRHQjlNc0pTa0IKZ3BQajZ6OTBHbFc3d0dRc25CQ0NNdmtwTzMzRVY0MWlPa0MzYnU3Ym50NXVkTi9kbEg0ZndnMzYrUWdpMnlTegpuVW5OUUNOQkRJTWNRcmFvcjlKdG5SWDAzYXVpY3ZSeEpGQ2lvL1gvNjNIMUFHZERKaFNWaUxRVjlqVjZhNlpNCjFMNDljUVVwekhSSlpPRGV1MnNIc2kxR0JuLzVnUStXSVR2RFp3SGQ0TjJGTkhmOXlJS1ZVQmkzVVRXQmpRRS8KVm15dkZVcmVBYnlldElzbEcvZVVVRkUyeFFhSzFXS2dMVUJrOXRnc3pycXFkNW11Y25ESmZ1elhkclArc1U2YQpkL1kvZVgxN3RKaG5xa25MZ25mVG91NTVLak9XdE93ZzN4OWt5amQ5bkFNQ0F3RUFBVEFOQmdrcWhraUc5dzBCCkFRc0ZBQU9DQVFFQXhyY1ppemR0L0wxWjVYQnE2R0djWTNSbzB0ZEdjdGZHZ0NsdjRvRzVTaE5BQmRhQTIvQ1YKVkE0TGtkb3JYV09hQWNGaWxpcFBlN0tGYVdIZ3EwZ3Q0eEt4LzlkOVZIcU5OY2srTlk0U3dHNDNrWjMyQWQ0QwpnUlowNEVhc1g3aG5wOG13alpLQ0FIWkpGK2krdC9sSFJOaEFDUzFGMHpyQmMrK3NUek5RK1dnTnVEbzN2OWkyCkNoZ1BRbEtBc3M0enM1NGE1RmJOTDJkWWJqNGRraXhJNDMwbU15dXg4SGJPUWFzVm9DVnpXcWtLa29RN25kdUgKRVBrWU0zRy9yVXRQZzhOVU1VVnlkdDFVbnlkb3c4cnhYYjZiQzYreTFQc2FrWHhSdW10ZFlnbDN3UWtJaitGUAoxVFgwSU9qKzdNZnR0cWdxemFhUm85V0s1Y3dpZTBlRGZBPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=\"\n                }\n            ],\n            \"policies\": [\n                {\n                    \"type\": \"app_protect\",\n                    \"name\": \"test_policy\",\n                    \"contents\": \"eyJwb2xpY3kiOnsiYXBwbGljYXRpb25MYW5ndWFnZSI6InV0Zi04IiwiYmxvY2tpbmctc2V0dGluZ3MiOnsiZXZhc2lvbnMiOlt7ImRlc2NyaXB0aW9uIjoiQXBhY2hlIHdoaXRlc3BhY2UiLCJlbmFibGVkIjp0cnVlfSx7ImRlc2NyaXB0aW9uIjoiQmFkIHVuZXNjYXBlIiwiZW5hYmxlZCI6dHJ1ZX0seyJkZXNjcmlwdGlvbiI6IkJhcmUgYnl0ZSBkZWNvZGluZyIsImVuYWJsZWQiOnRydWV9LHsiZGVzY3JpcHRpb24iOiJEaXJlY3RvcnkgdHJhdmVyc2FscyIsImVuYWJsZWQiOnRydWV9LHsiZGVzY3JpcHRpb24iOiJJSVMgVW5pY29kZSBjb2RlcG9pbnRzIiwiZW5hYmxlZCI6dHJ1ZX0seyJkZXNjcmlwdGlvbiI6IklJUyBiYWNrc2xhc2hlcyIsImVuYWJsZWQiOnRydWV9LHsiZGVzY3JpcHRpb24iOiJNdWx0aXBsZSBkZWNvZGluZyIsImVuYWJsZWQiOnRydWUsIm1heERlY29kaW5nUGFzc2VzIjoyfV0sImh0dHAtcHJvdG9jb2xzIjpbeyJkZXNjcmlwdGlvbiI6IkhlYWRlciBuYW1lIHdpdGggbm8gaGVhZGVyIHZhbHVlIiwiZW5hYmxlZCI6dHJ1ZX1dLCJ2aW9sYXRpb25zIjpbeyJhbGFybSI6dHJ1ZSwiYmxvY2siOmZhbHNlLCJuYW1lIjoiVklPTF9EQVRBX0dVQVJEIn0seyJhbGFybSI6dHJ1ZSwiYmxvY2siOnRydWUsIm5hbWUiOiJWSU9MX0hUVFBfUFJPVE9DT0wifSx7ImFsYXJtIjp0cnVlLCJibG9jayI6dHJ1ZSwibmFtZSI6IlZJT0xfRklMRVRZUEUifSx7ImFsYXJtIjp0cnVlLCJibG9jayI6dHJ1ZSwibmFtZSI6IlZJT0xfSEVBREVSX01FVEFDSEFSIn0seyJhbGFybSI6dHJ1ZSwiYmxvY2siOnRydWUsIm5hbWUiOiJWSU9MX0VWQVNJT04ifV19LCJkYXRhLWd1YXJkIjp7ImNyZWRpdENhcmROdW1iZXJzIjp0cnVlLCJlbmFibGVkIjp0cnVlLCJlbmZvcmNlbWVudE1vZGUiOiJpZ25vcmUtdXJscy1pbi1saXN0IiwiZW5mb3JjZW1lbnRVcmxzIjpbXSwibWFza0RhdGEiOnRydWUsInVzU29jaWFsU2VjdXJpdHlOdW1iZXJzIjp0cnVlfSwiZW5mb3JjZW1lbnRNb2RlIjoiYmxvY2tpbmciLCJmaWxldHlwZXMiOlt7ImFsbG93ZWQiOnRydWUsImNoZWNrUG9zdERhdGFMZW5ndGgiOmZhbHNlLCJjaGVja1F1ZXJ5U3RyaW5nTGVuZ3RoIjp0cnVlLCJjaGVja1JlcXVlc3RMZW5ndGgiOmZhbHNlLCJjaGVja1VybExlbmd0aCI6dHJ1ZSwibmFtZSI6IioiLCJwb3N0RGF0YUxlbmd0aCI6NDA5NiwicXVlcnlTdHJpbmdMZW5ndGgiOjIwNDgsInJlcXVlc3RMZW5ndGgiOjgxOTIsInJlc3BvbnNlQ2hlY2siOmZhbHNlLCJ0eXBlIjoid2lsZGNhcmQiLCJ1cmxMZW5ndGgiOjIwNDh9LHsiYWxsb3dlZCI6ZmFsc2UsIm5hbWUiOiJiYXQifV0sImdlbmVyYWwiOnsidHJ1c3RYZmYiOnRydWV9LCJuYW1lIjoibmdpbngtcG9saWN5Iiwic2lnbmF0dXJlLXNldHMiOlt7ImFsYXJtIjp0cnVlLCJibG9jayI6dHJ1ZSwibmFtZSI6IkNvbW1hbmQgRXhlY3V0aW9uIFNpZ25hdHVyZXMifSx7ImFsYXJtIjp0cnVlLCJibG9jayI6dHJ1ZSwibmFtZSI6IkNyb3NzIFNpdGUgU2NyaXB0aW5nIFNpZ25hdHVyZXMifSx7ImFsYXJtIjp0cnVlLCJibG9jayI6dHJ1ZSwibmFtZSI6IlNRTCBJbmplY3Rpb24gU2lnbmF0dXJlcyJ9XSwic2lnbmF0dXJlLXNldHRpbmdzIjp7Im1pbmltdW1BY2N1cmFjeUZvckF1dG9BZGRlZFNpZ25hdHVyZXMiOiJsb3cifSwidGVtcGxhdGUiOnsibmFtZSI6IlBPTElDWV9URU1QTEFURV9OR0lOWF9CQVNFIn19fQo=\"\n                }\n            ],\n            \"log_profiles\": [\n                {\n                    \"type\": \"app_protect\",\n                    \"app_protect\": {\n                        \"name\": \"okta\",\n                        \"format\": \"user-defined\",\n                        \"format_string\": \"%date_time%|K|%ip_client%|K|%violation_rating%|K|%violations%\",\n                        \"type\": \"all\",\n                        \"max_request_size\": \"any\",\n                        \"max_message_size\": \"5k\"\n                    }\n                },\n                {\n                    \"type\": \"app_protect\",\n                    \"app_protect\": {\n                        \"name\": \"default\",\n                        \"format\": \"default\",\n                        \"type\": \"all\",\n                        \"max_request_size\": \"any\",\n                        \"max_message_size\": \"5k\"\n                    }\n                }\n            ]\n        }\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"tcp\",\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"upstream\": \"l4_upstream\",\n                    \"snippet\": \"IyBUaGlzIGlzIGEgbDQgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/test\",\n                            \"urimatch\": \"exact\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true,\n                                \"uri\": \"/healthcheck\",\n                                \"interval\": 5,\n                                \"fails\": 3,\n                                \"passes\": 2\n                            },\n                            \"rate_limit\": {\n                                \"profile\": \"test_ratelimit\",\n                                \"httpcode\": 429,\n                                \"burst\": 10,\n                                \"delay\": 3\n                            },\n                            \"app_protect\": {\n                                \"enabled\": true,\n                                \"policy\": \"test_policy\",\n                                \"log\": {\n                                    \"profile_name\": \"okta\",\n                                    \"enabled\": true,\n                                    \"destination\": \"192.168.1.5:514\"\n                                }\n                            },\n                            \"snippet\": \"IyBUaGlzIGlzIGEgbG9jYXRpb24gc25pcHBldCBjb21tZW50Cg==\"\n                        }\n                    ],\n                    \"app_protect\": {\n                        \"enabled\": true,\n                        \"policy\": \"test_policy\",\n                        \"log\": {\n                            \"profile_name\": \"default\",\n                            \"enabled\": true,\n                            \"destination\": \"192.168.1.5:514\"\n                        }\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgc2VydmVyIHNuaXBwZXQgY29tbWVudAo=\"\n                },\n                {\n                    \"names\": [\n                        \"server_443\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:443\",\n                        \"http2\": true,\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"upstream\": \"http://test_upstream\"\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\",\n                            \"weight\": 5,\n                            \"max_fails\": 2,\n                            \"fail_timeout\": \"30s\",\n                            \"max_conns\": 3,\n                            \"slow_start\": \"30s\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\",\n                            \"backup\": true\n                        }\n                    ],\n                    \"sticky\": {\n                        \"cookie\": \"cookie_name\",\n                        \"expires\": \"1h\",\n                        \"domain\": \".testserver\",\n                        \"path\": \"/\"\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"rate_limit\": [\n                {\n                    \"name\": \"test_ratelimit\",\n                    \"key\": \"$binary_remote_addr\",\n                    \"size\": \"10m\",\n                    \"rate\": \"1r/s\"\n                }\n            ],\n            \"maps\": [\n                {\n                    \"match\": \"$host$request_uri\",\n                    \"variable\": \"$backend\",\n                    \"entries\": [\n                        {\n                            \"key\": \"www.test.lab/app1/\",\n                            \"keymatch\": \"iregex\",\n                            \"value\": \"upstream_1\"\n                        },\n                        {\n                            \"key\": \"(.*).test.lab/app2/\",\n                            \"keymatch\": \"regex\",\n                            \"value\": \"upstream_2\"\n                        }\n                    ]\n                }\n            ],\n            \"nginx_plus_api\": {\n                \"write\": true,\n                \"listen\": \"127.0.0.1:8080\",\n                \"allow_acl\": \"0.0.0.0/0\"\n            },\n            \"snippet\": \"IyBUaGlzIGlzIGEgSFRUUCBzbmlwcGV0IGNvbW1lbnQK\"\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v1/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v1",
												"config"
											]
										}
									},
									"response": []
								}
							]
						}
					]
				},
				{
					"name": "GitOps",
					"item": [
						{
							"name": "GitOps - NGINX as source of truth",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var respData = JSON.parse(responseBody);",
											"",
											"tests[\"configUid is: \" +respData.configUid] = respData.configUid;",
											"",
											"pm.collectionVariables.set('configUid',respData.configUid);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"synctime\": {{nim_synctime}},\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ],\n            \"certificates\": [\n                {\n                    \"type\": \"certificate\",\n                    \"name\": \"test_cert\",\n                    \"contents\": \"http://acme.gitlab.local/test.crt\"\n                },\n                {\n                    \"type\": \"key\",\n                    \"name\": \"test_key\",\n                    \"contents\": \"http://acme.gitlab.local/test.key\"\n                },\n                {\n                    \"type\": \"chain\",\n                    \"name\": \"test_chain\",\n                    \"contents\": \"http://acme.gitlab.local/test.chain\"\n                }\n            ],\n            \"policies\": [\n                {\n                    \"type\": \"app_protect\",\n                    \"name\": \"test_policy\",\n                    \"contents\": \"http://acme.gitlab.local/testpolicy.nap\"\n                }\n            ],\n            \"log_profiles\": [\n                {\n                    \"type\": \"app_protect\",\n                    \"app_protect\": {\n                        \"name\": \"okta\",\n                        \"format\": \"user-defined\",\n                        \"format_string\": \"%date_time%|K|%ip_client%|K|%violation_rating%|K|%violations%\",\n                        \"type\": \"all\",\n                        \"max_request_size\": \"any\",\n                        \"max_message_size\": \"5k\"\n                    }\n                },\n                {\n                    \"type\": \"app_protect\",\n                    \"app_protect\": {\n                        \"name\": \"default\",\n                        \"format\": \"default\",\n                        \"type\": \"all\",\n                        \"max_request_size\": \"any\",\n                        \"max_message_size\": \"5k\"\n                    }\n                }\n            ]\n        }\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"tcp\",\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"upstream\": \"l4_upstream\",\n                    \"snippet\": \"http://acme.gitlab.local/test.snippet.server.l4\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/test\",\n                            \"urimatch\": \"exact\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true,\n                                \"uri\": \"/healthcheck\",\n                                \"interval\": 5,\n                                \"fails\": 3,\n                                \"passes\": 2\n                            },\n                            \"rate_limit\": {\n                                \"profile\": \"test_ratelimit\",\n                                \"httpcode\": 429,\n                                \"burst\": 10,\n                                \"delay\": 3\n                            },\n                            \"app_protect\": {\n                                \"enabled\": true,\n                                \"policy\": \"test_policy\",\n                                \"log\": {\n                                    \"profile_name\": \"okta\",\n                                    \"enabled\": true,\n                                    \"destination\": \"192.168.1.5:514\"\n                                }\n                            },\n                            \"snippet\": \"http://acme.gitlab.local/test.snippet.location\"\n                        }\n                    ],\n                    \"app_protect\": {\n                        \"enabled\": true,\n                        \"policy\": \"test_policy\",\n                        \"log\": {\n                            \"profile_name\": \"default\",\n                            \"enabled\": true,\n                            \"destination\": \"192.168.1.5:514\"\n                        }\n                    },\n                    \"snippet\": \"http://acme.gitlab.local/test.snippet.server\"\n                },\n                {\n                    \"names\": [\n                        \"server_443\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:443\",\n                        \"http2\": true,\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"upstream\": \"http://test_upstream\"\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\",\n                            \"weight\": 5,\n                            \"max_fails\": 2,\n                            \"fail_timeout\": \"30s\",\n                            \"max_conns\": 3,\n                            \"slow_start\": \"30s\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\",\n                            \"backup\": true\n                        }\n                    ],\n                    \"sticky\": {\n                        \"cookie\": \"cookie_name\",\n                        \"expires\": \"1h\",\n                        \"domain\": \".testserver\",\n                        \"path\": \"/\"\n                    },\n                    \"snippet\": \"http://acme.gitlab.local/test.snippet.upstream\"\n                }\n            ],\n            \"rate_limit\": [\n                {\n                    \"name\": \"test_ratelimit\",\n                    \"key\": \"$binary_remote_addr\",\n                    \"size\": \"10m\",\n                    \"rate\": \"1r/s\"\n                }\n            ],\n            \"maps\": [\n                {\n                    \"match\": \"$host$request_uri\",\n                    \"variable\": \"$backend\",\n                    \"entries\": [\n                        {\n                            \"key\": \"www.test.lab/app1/\",\n                            \"keymatch\": \"iregex\",\n                            \"value\": \"upstream_1\"\n                        },\n                        {\n                            \"key\": \"(.*).test.lab/app2/\",\n                            \"keymatch\": \"regex\",\n                            \"value\": \"upstream_2\"\n                        }\n                    ]\n                }\n            ],\n            \"nginx_plus_api\": {\n                \"write\": true,\n                \"listen\": \"127.0.0.1:8080\",\n                \"allow_acl\": \"0.0.0.0/0\"\n            },\n            \"snippet\": \"http://acme.gitlab.local/test.snippet.http\"\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v1/config",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v1",
										"config"
									]
								}
							},
							"response": []
						},
						{
							"name": "GitOps - GitHub as source of truth",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var respData = JSON.parse(responseBody);",
											"",
											"tests[\"configUid is: \" +respData.configUid] = respData.configUid;",
											"",
											"pm.collectionVariables.set('configUid',respData.configUid);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"synctime\": {{nim_synctime}},\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ],\n            \"certificates\": [\n                {\n                    \"type\": \"certificate\",\n                    \"name\": \"test_cert\",\n                    \"contents\": \"{{github_root}}/test.crt\"\n                },\n                {\n                    \"type\": \"key\",\n                    \"name\": \"test_key\",\n                    \"contents\": \"{{github_root}}/test.key\"\n                },\n                {\n                    \"type\": \"chain\",\n                    \"name\": \"test_chain\",\n                    \"contents\": \"{{github_root}}/test.chain\"\n                }\n            ],\n            \"policies\": [\n                {\n                    \"type\": \"app_protect\",\n                    \"name\": \"test_policy\",\n                    \"contents\": \"{{github_root}}/nap-policy.json\"\n                }\n            ],\n            \"log_profiles\": [\n                {\n                    \"type\": \"app_protect\",\n                    \"app_protect\": {\n                        \"name\": \"okta\",\n                        \"format\": \"user-defined\",\n                        \"format_string\": \"%date_time%|K|%ip_client%|K|%violation_rating%|K|%violations%\",\n                        \"type\": \"all\",\n                        \"max_request_size\": \"any\",\n                        \"max_message_size\": \"5k\"\n                    }\n                },\n                {\n                    \"type\": \"app_protect\",\n                    \"app_protect\": {\n                        \"name\": \"default\",\n                        \"format\": \"default\",\n                        \"type\": \"all\",\n                        \"max_request_size\": \"any\",\n                        \"max_message_size\": \"5k\"\n                    }\n                }\n            ]\n        }\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"tcp\",\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"upstream\": \"l4_upstream\",\n                    \"snippet\": \"{{github_root}}/test.snippet.server.l4\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/test\",\n                            \"urimatch\": \"exact\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true,\n                                \"uri\": \"/healthcheck\",\n                                \"interval\": 5,\n                                \"fails\": 3,\n                                \"passes\": 2\n                            },\n                            \"rate_limit\": {\n                                \"profile\": \"test_ratelimit\",\n                                \"httpcode\": 429,\n                                \"burst\": 10,\n                                \"delay\": 3\n                            },\n                            \"app_protect\": {\n                                \"enabled\": true,\n                                \"policy\": \"test_policy\",\n                                \"log\": {\n                                    \"profile_name\": \"okta\",\n                                    \"enabled\": true,\n                                    \"destination\": \"192.168.1.5:514\"\n                                }\n                            },\n                            \"snippet\": \"{{github_root}}/test.snippet.location\"\n                        }\n                    ],\n                    \"app_protect\": {\n                        \"enabled\": true,\n                        \"policy\": \"test_policy\",\n                        \"log\": {\n                            \"profile_name\": \"default\",\n                            \"enabled\": true,\n                            \"destination\": \"192.168.1.5:514\"\n                        }\n                    },\n                    \"snippet\": \"{{github_root}}/test.snippet.server\"\n                },\n                {\n                    \"names\": [\n                        \"server_443\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:443\",\n                        \"http2\": true,\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"upstream\": \"http://test_upstream\"\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\",\n                            \"weight\": 5,\n                            \"max_fails\": 2,\n                            \"fail_timeout\": \"30s\",\n                            \"max_conns\": 3,\n                            \"slow_start\": \"30s\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\",\n                            \"backup\": true\n                        }\n                    ],\n                    \"sticky\": {\n                        \"cookie\": \"cookie_name\",\n                        \"expires\": \"1h\",\n                        \"domain\": \".testserver\",\n                        \"path\": \"/\"\n                    },\n                    \"snippet\": \"{{github_root}}/test.snippet.upstream\"\n                }\n            ],\n            \"rate_limit\": [\n                {\n                    \"name\": \"test_ratelimit\",\n                    \"key\": \"$binary_remote_addr\",\n                    \"size\": \"10m\",\n                    \"rate\": \"1r/s\"\n                }\n            ],\n            \"maps\": [\n                {\n                    \"match\": \"$host$request_uri\",\n                    \"variable\": \"$backend\",\n                    \"entries\": [\n                        {\n                            \"key\": \"www.test.lab/app1/\",\n                            \"keymatch\": \"iregex\",\n                            \"value\": \"upstream_1\"\n                        },\n                        {\n                            \"key\": \"(.*).test.lab/app2/\",\n                            \"keymatch\": \"regex\",\n                            \"value\": \"upstream_2\"\n                        }\n                    ]\n                }\n            ],\n            \"nginx_plus_api\": {\n                \"write\": true,\n                \"listen\": \"127.0.0.1:8080\",\n                \"allow_acl\": \"0.0.0.0/0\"\n            },\n            \"snippet\": \"{{github_root}}/test.snippet.http\"\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v1/config",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v1",
										"config"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get GitOps declaration",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v1/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v1",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get GitOps declaration status",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v1/config/{{configUid}}/status",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v1",
										"config",
										"{{configUid}}",
										"status"
									]
								}
							},
							"response": []
						},
						{
							"name": "Delete GitOps declaration",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "DELETE",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v1/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v1",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						}
					]
				}
			]
		},
		{
			"name": "v2",
			"item": [
				{
					"name": "Configuration generation",
					"item": [
						{
							"name": "Basic - LB",
							"item": [
								{
									"name": "Basic - LB - plaintext output",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"plaintext\"\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"name\": \"sample L4 service\",\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"udp\"\n                    },\n                    \"upstream\": \"l4_upstream\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"name\": \"A sample HTTP service\",\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"urimatch\": \"prefix\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true\n                            }\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v2",
												"config"
											]
										}
									},
									"response": []
								},
								{
									"name": "Basic - LB - json b64 encoded output",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"json\"\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"name\": \"sample L4 service\",\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"udp\"\n                    },\n                    \"upstream\": \"l4_upstream\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"name\": \"A sample HTTP service\",\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"urimatch\": \"prefix\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true\n                            }\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v2",
												"config"
											]
										}
									},
									"response": []
								},
								{
									"name": "Basic - LB - ConfigMap output",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"configmap\",\n        \"configmap\": {\n            \"name\": \"nginx.test\",\n            \"filename\": \"testservice.conf\",\n            \"namespace\": \"test-namespace\"\n        }\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"name\": \"sample L4 service\",\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"udp\"\n                    },\n                    \"upstream\": \"l4_upstream\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"name\": \"A sample HTTP service\",\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"urimatch\": \"prefix\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true\n                            }\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v2",
												"config"
											]
										}
									},
									"response": []
								},
								{
									"name": "Basic - LB - HTTP output",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"http\",\n        \"http\": {\n            \"url\": \"http://192.168.1.19:8080/path/service\"\n        }\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"name\": \"sample L4 service\",\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"udp\"\n                    },\n                    \"upstream\": \"l4_upstream\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"name\": \"A sample HTTP service\",\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"urimatch\": \"prefix\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true\n                            }\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v2",
												"config"
											]
										}
									},
									"response": []
								}
							]
						},
						{
							"name": "Advanced",
							"item": [
								{
									"name": "Advanced LB - plaintext output",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"plaintext\"\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"name\": \"sample_layer4_service\",\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"tcp\",\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"upstream\": \"l4_upstream\",\n                    \"snippet\": \"IyBUaGlzIGlzIGEgbDQgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"name\": \"HTTP test application\",\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/test\",\n                            \"urimatch\": \"exact\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true,\n                                \"uri\": \"/healthcheck\",\n                                \"interval\": 5,\n                                \"fails\": 3,\n                                \"passes\": 2\n                            },\n                            \"rate_limit\": {\n                                \"profile\": \"test_ratelimit\",\n                                \"httpcode\": 429,\n                                \"burst\": 10,\n                                \"delay\": 3\n                            },\n                            \"app_protect\": {\n                                \"enabled\": true,\n                                \"policy\": \"test_policy\",\n                                \"log\": {\n                                    \"profile_name\": \"log_illegal\",\n                                    \"enabled\": true,\n                                    \"destination\": \"192.168.1.5:514\"\n                                }\n                            },\n                            \"snippet\": \"IyBUaGlzIGlzIGEgbG9jYXRpb24gc25pcHBldCBjb21tZW50Cg==\"\n                        }\n                    ],\n                    \"app_protect\": {\n                        \"enabled\": true,\n                        \"policy\": \"test_policy\",\n                        \"log\": {\n                            \"profile_name\": \"log_blocked\",\n                            \"enabled\": true,\n                            \"destination\": \"192.168.1.5:514\"\n                        }\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgc2VydmVyIHNuaXBwZXQgY29tbWVudAo=\"\n                },\n                {\n                    \"name\": \"another HTTP test application\",\n                    \"names\": [\n                        \"server_443\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:443\",\n                        \"http2\": true,\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"upstream\": \"http://test_upstream\"\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\",\n                            \"weight\": 5,\n                            \"max_fails\": 2,\n                            \"fail_timeout\": \"30s\",\n                            \"max_conns\": 3,\n                            \"slow_start\": \"30s\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\",\n                            \"backup\": true\n                        }\n                    ],\n                    \"sticky\": {\n                        \"cookie\": \"cookie_name\",\n                        \"expires\": \"1h\",\n                        \"domain\": \".testserver\",\n                        \"path\": \"/\"\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"rate_limit\": [\n                {\n                    \"name\": \"test_ratelimit\",\n                    \"key\": \"$binary_remote_addr\",\n                    \"size\": \"10m\",\n                    \"rate\": \"1r/s\"\n                }\n            ],\n            \"maps\": [\n                {\n                    \"match\": \"$host$request_uri\",\n                    \"variable\": \"$backend\",\n                    \"entries\": [\n                        {\n                            \"key\": \"www.test.lab/app1/\",\n                            \"keymatch\": \"iregex\",\n                            \"value\": \"upstream_1\"\n                        },\n                        {\n                            \"key\": \"(.*).test.lab/app2/\",\n                            \"keymatch\": \"regex\",\n                            \"value\": \"upstream_2\"\n                        }\n                    ]\n                }\n            ],\n            \"nginx_plus_api\": {\n                \"write\": true,\n                \"listen\": \"127.0.0.1:8080\",\n                \"allow_acl\": \"0.0.0.0/0\"\n            },\n            \"snippet\": \"IyBUaGlzIGlzIGEgSFRUUCBzbmlwcGV0IGNvbW1lbnQK\"\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v2",
												"config"
											]
										}
									},
									"response": []
								},
								{
									"name": "Advanced LB - json b64 encoded output",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"json\"\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"name\": \"sample_layer4_service\",\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"tcp\",\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"upstream\": \"l4_upstream\",\n                    \"snippet\": \"IyBUaGlzIGlzIGEgbDQgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"name\": \"HTTP test application\",\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/test\",\n                            \"urimatch\": \"exact\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true,\n                                \"uri\": \"/healthcheck\",\n                                \"interval\": 5,\n                                \"fails\": 3,\n                                \"passes\": 2\n                            },\n                            \"rate_limit\": {\n                                \"profile\": \"test_ratelimit\",\n                                \"httpcode\": 429,\n                                \"burst\": 10,\n                                \"delay\": 3\n                            },\n                            \"app_protect\": {\n                                \"enabled\": true,\n                                \"policy\": \"test_policy\",\n                                \"log\": {\n                                    \"profile_name\": \"log_illegal\",\n                                    \"enabled\": true,\n                                    \"destination\": \"192.168.1.5:514\"\n                                }\n                            },\n                            \"snippet\": \"IyBUaGlzIGlzIGEgbG9jYXRpb24gc25pcHBldCBjb21tZW50Cg==\"\n                        }\n                    ],\n                    \"app_protect\": {\n                        \"enabled\": true,\n                        \"policy\": \"test_policy\",\n                        \"log\": {\n                            \"profile_name\": \"log_blocked\",\n                            \"enabled\": true,\n                            \"destination\": \"192.168.1.5:514\"\n                        }\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgc2VydmVyIHNuaXBwZXQgY29tbWVudAo=\"\n                },\n                {\n                    \"name\": \"another HTTP test application\",\n                    \"names\": [\n                        \"server_443\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:443\",\n                        \"http2\": true,\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"upstream\": \"http://test_upstream\"\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\",\n                            \"weight\": 5,\n                            \"max_fails\": 2,\n                            \"fail_timeout\": \"30s\",\n                            \"max_conns\": 3,\n                            \"slow_start\": \"30s\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\",\n                            \"backup\": true\n                        }\n                    ],\n                    \"sticky\": {\n                        \"cookie\": \"cookie_name\",\n                        \"expires\": \"1h\",\n                        \"domain\": \".testserver\",\n                        \"path\": \"/\"\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"rate_limit\": [\n                {\n                    \"name\": \"test_ratelimit\",\n                    \"key\": \"$binary_remote_addr\",\n                    \"size\": \"10m\",\n                    \"rate\": \"1r/s\"\n                }\n            ],\n            \"maps\": [\n                {\n                    \"match\": \"$host$request_uri\",\n                    \"variable\": \"$backend\",\n                    \"entries\": [\n                        {\n                            \"key\": \"www.test.lab/app1/\",\n                            \"keymatch\": \"iregex\",\n                            \"value\": \"upstream_1\"\n                        },\n                        {\n                            \"key\": \"(.*).test.lab/app2/\",\n                            \"keymatch\": \"regex\",\n                            \"value\": \"upstream_2\"\n                        }\n                    ]\n                }\n            ],\n            \"nginx_plus_api\": {\n                \"write\": true,\n                \"listen\": \"127.0.0.1:8080\",\n                \"allow_acl\": \"0.0.0.0/0\"\n            },\n            \"snippet\": \"IyBUaGlzIGlzIGEgSFRUUCBzbmlwcGV0IGNvbW1lbnQK\"\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v2",
												"config"
											]
										}
									},
									"response": []
								},
								{
									"name": "Advanced LB - ConfigMap output",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"configmap\",\n        \"configmap\": {\n            \"name\": \"nginx.test\",\n            \"filename\": \"testservice.conf\",\n            \"namespace\": \"test-namespace\"\n        }\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"name\": \"sample_layer4_service\",\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"tcp\",\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"upstream\": \"l4_upstream\",\n                    \"snippet\": \"IyBUaGlzIGlzIGEgbDQgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"name\": \"HTTP test application\",\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/test\",\n                            \"urimatch\": \"exact\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true,\n                                \"uri\": \"/healthcheck\",\n                                \"interval\": 5,\n                                \"fails\": 3,\n                                \"passes\": 2\n                            },\n                            \"rate_limit\": {\n                                \"profile\": \"test_ratelimit\",\n                                \"httpcode\": 429,\n                                \"burst\": 10,\n                                \"delay\": 3\n                            },\n                            \"app_protect\": {\n                                \"enabled\": true,\n                                \"policy\": \"test_policy\",\n                                \"log\": {\n                                    \"profile_name\": \"log_illegal\",\n                                    \"enabled\": true,\n                                    \"destination\": \"192.168.1.5:514\"\n                                }\n                            },\n                            \"snippet\": \"IyBUaGlzIGlzIGEgbG9jYXRpb24gc25pcHBldCBjb21tZW50Cg==\"\n                        }\n                    ],\n                    \"app_protect\": {\n                        \"enabled\": true,\n                        \"policy\": \"test_policy\",\n                        \"log\": {\n                            \"profile_name\": \"log_blocked\",\n                            \"enabled\": true,\n                            \"destination\": \"192.168.1.5:514\"\n                        }\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgc2VydmVyIHNuaXBwZXQgY29tbWVudAo=\"\n                },\n                {\n                    \"name\": \"another HTTP test application\",\n                    \"names\": [\n                        \"server_443\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:443\",\n                        \"http2\": true,\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"upstream\": \"http://test_upstream\"\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\",\n                            \"weight\": 5,\n                            \"max_fails\": 2,\n                            \"fail_timeout\": \"30s\",\n                            \"max_conns\": 3,\n                            \"slow_start\": \"30s\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\",\n                            \"backup\": true\n                        }\n                    ],\n                    \"sticky\": {\n                        \"cookie\": \"cookie_name\",\n                        \"expires\": \"1h\",\n                        \"domain\": \".testserver\",\n                        \"path\": \"/\"\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"rate_limit\": [\n                {\n                    \"name\": \"test_ratelimit\",\n                    \"key\": \"$binary_remote_addr\",\n                    \"size\": \"10m\",\n                    \"rate\": \"1r/s\"\n                }\n            ],\n            \"maps\": [\n                {\n                    \"match\": \"$host$request_uri\",\n                    \"variable\": \"$backend\",\n                    \"entries\": [\n                        {\n                            \"key\": \"www.test.lab/app1/\",\n                            \"keymatch\": \"iregex\",\n                            \"value\": \"upstream_1\"\n                        },\n                        {\n                            \"key\": \"(.*).test.lab/app2/\",\n                            \"keymatch\": \"regex\",\n                            \"value\": \"upstream_2\"\n                        }\n                    ]\n                }\n            ],\n            \"nginx_plus_api\": {\n                \"write\": true,\n                \"listen\": \"127.0.0.1:8080\",\n                \"allow_acl\": \"0.0.0.0/0\"\n            },\n            \"snippet\": \"IyBUaGlzIGlzIGEgSFRUUCBzbmlwcGV0IGNvbW1lbnQK\"\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v2",
												"config"
											]
										}
									},
									"response": []
								},
								{
									"name": "Advanced LB - HTTP output",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"output\": {\n        \"type\": \"http\",\n        \"http\": {\n            \"url\": \"http://192.168.1.19:8080/path/service\"\n        }\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"name\": \"sample_layer4_service\",\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"tcp\",\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"upstream\": \"l4_upstream\",\n                    \"snippet\": \"IyBUaGlzIGlzIGEgbDQgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        }\n                    ]\n                }\n            ]\n        },\n        \"http\": {\n            \"servers\": [\n                {\n                    \"name\": \"HTTP test application\",\n                    \"names\": [\n                        \"server_8080.nginx.lab\",\n                        \"server_8081.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/test\",\n                            \"urimatch\": \"exact\",\n                            \"upstream\": \"http://test_upstream\",\n                            \"health_check\": {\n                                \"enabled\": true,\n                                \"uri\": \"/healthcheck\",\n                                \"interval\": 5,\n                                \"fails\": 3,\n                                \"passes\": 2\n                            },\n                            \"rate_limit\": {\n                                \"profile\": \"test_ratelimit\",\n                                \"httpcode\": 429,\n                                \"burst\": 10,\n                                \"delay\": 3\n                            },\n                            \"app_protect\": {\n                                \"enabled\": true,\n                                \"policy\": \"test_policy\",\n                                \"log\": {\n                                    \"profile_name\": \"log_illegal\",\n                                    \"enabled\": true,\n                                    \"destination\": \"192.168.1.5:514\"\n                                }\n                            },\n                            \"snippet\": \"IyBUaGlzIGlzIGEgbG9jYXRpb24gc25pcHBldCBjb21tZW50Cg==\"\n                        }\n                    ],\n                    \"app_protect\": {\n                        \"enabled\": true,\n                        \"policy\": \"test_policy\",\n                        \"log\": {\n                            \"profile_name\": \"log_blocked\",\n                            \"enabled\": true,\n                            \"destination\": \"192.168.1.5:514\"\n                        }\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgc2VydmVyIHNuaXBwZXQgY29tbWVudAo=\"\n                },\n                {\n                    \"name\": \"another HTTP test application\",\n                    \"names\": [\n                        \"server_443\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:443\",\n                        \"http2\": true,\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"upstream\": \"http://test_upstream\"\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\",\n                            \"weight\": 5,\n                            \"max_fails\": 2,\n                            \"fail_timeout\": \"30s\",\n                            \"max_conns\": 3,\n                            \"slow_start\": \"30s\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\",\n                            \"backup\": true\n                        }\n                    ],\n                    \"sticky\": {\n                        \"cookie\": \"cookie_name\",\n                        \"expires\": \"1h\",\n                        \"domain\": \".testserver\",\n                        \"path\": \"/\"\n                    },\n                    \"snippet\": \"IyBUaGlzIGlzIGEgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==\"\n                }\n            ],\n            \"rate_limit\": [\n                {\n                    \"name\": \"test_ratelimit\",\n                    \"key\": \"$binary_remote_addr\",\n                    \"size\": \"10m\",\n                    \"rate\": \"1r/s\"\n                }\n            ],\n            \"maps\": [\n                {\n                    \"match\": \"$host$request_uri\",\n                    \"variable\": \"$backend\",\n                    \"entries\": [\n                        {\n                            \"key\": \"www.test.lab/app1/\",\n                            \"keymatch\": \"iregex\",\n                            \"value\": \"upstream_1\"\n                        },\n                        {\n                            \"key\": \"(.*).test.lab/app2/\",\n                            \"keymatch\": \"regex\",\n                            \"value\": \"upstream_2\"\n                        }\n                    ]\n                }\n            ],\n            \"nginx_plus_api\": {\n                \"write\": true,\n                \"listen\": \"127.0.0.1:8080\",\n                \"allow_acl\": \"0.0.0.0/0\"\n            },\n            \"snippet\": \"IyBUaGlzIGlzIGEgSFRUUCBzbmlwcGV0IGNvbW1lbnQK\"\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config",
											"protocol": "http",
											"host": [
												"{{ncg_host}}"
											],
											"port": "{{ncg_port}}",
											"path": [
												"v2",
												"config"
											]
										}
									},
									"response": []
								}
							]
						}
					]
				},
				{
					"name": "Declarative automation - NGINX App Protect WAF",
					"item": [
						{
							"name": "Create initial NGINX configuration with NGINX App Protect WAF",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var respData = JSON.parse(responseBody);",
											"",
											"tests[\"configUid is: \" +respData.configUid] = respData.configUid;",
											"",
											"pm.collectionVariables.set('configUid',respData.configUid);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"synctime\": 0,\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ],\n            \"certificates\": [\n                {\n                    \"type\": \"certificate\",\n                    \"name\": \"test_cert\",\n                    \"contents\": \"{{github_gitops_root}}/v2/www.online-boutique.local.crt\"\n                },\n                {\n                    \"type\": \"key\",\n                    \"name\": \"test_key\",\n                    \"contents\": \"{{github_gitops_root}}/v2/www.online-boutique.local.key\"\n                },\n                {\n                    \"type\": \"chain\",\n                    \"name\": \"test_chain\",\n                    \"contents\": \"{{github_gitops_root}}/v2/www.online-boutique.local.chain\"\n                }\n            ],\n            \"policies\": [\n                {\n                    \"type\": \"app_protect\",\n                    \"name\": \"production-policy\",\n                    \"active_tag\": \"xss-blocked\",\n                    \"versions\": [\n                        {\n                            \"tag\": \"xss-blocked\",\n                            \"displayName\": \"Production Policy - XSS blocked\",\n                            \"description\": \"This is a production-ready policy - XSS blocked\",\n                            \"contents\": \"{{github_gitops_root}}/v2/nap-policy-xss-blocked.json\"\n                        },\n                        {\n                            \"tag\": \"xss-allowed\",\n                            \"displayName\": \"Production Policy - XSS allowed\",\n                            \"description\": \"This is a production-ready policy - XSS allowed\",\n                            \"contents\": \"{{github_gitops_root}}/v2/nap-policy-xss-allowed.json\"\n                        }\n                    ]\n                }\n            ]\n        }\n    },\n    \"declaration\": {\n        \"http\": {\n            \"servers\": [\n                {\n                    \"name\": \"Online boutique HTTPS\",\n                    \"names\": [\n                        \"www.online-boutique.lan\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"0.0.0.0:443\",\n                        \"http2\": true,\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/online_boutique_https_access_log\",\n                        \"error\": \"/var/log/nginx/online_boutique_https_error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"urimatch\": \"prefix\",\n                            \"upstream\": \"http://upstream_boutique\"\n                        }\n                    ],\n                    \"app_protect\": {\n                        \"enabled\": true,\n                        \"policy\": \"production-policy\",\n                        \"log\": {\n                            \"profile_name\": \"secops_dashboard\",\n                            \"enabled\": true,\n                            \"destination\": \"127.0.0.1:514\"\n                        }\n                    }\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"upstream_boutique\",\n                    \"origin\": [\n                        {\n                            \"server\": \"192.168.1.200:80\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config"
									]
								}
							},
							"response": []
						},
						{
							"name": "Change active NGINX App Protect policy",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var respData = JSON.parse(responseBody);",
											"",
											"tests[\"configUid is: \" +respData.configUid] = respData.configUid;",
											"",
											"pm.collectionVariables.set('configUid',respData.configUid);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"synctime\": 0,\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ],\n            \"policies\": [\n                {\n                    \"type\": \"app_protect\",\n                    \"name\": \"production-policy\",\n                    \"active_tag\": \"xss-allowed\",\n                    \"versions\": [\n                        {\n                            \"tag\": \"xss-blocked\",\n                            \"displayName\": \"Production Policy - XSS blocked\",\n                            \"description\": \"Production-ready policy - XSS blocked\",\n                            \"contents\": \"{{github_gitops_root}}/v2/nap-policy-xss-blocked.json\"\n                        },\n                        {\n                            \"tag\": \"xss-allowed\",\n                            \"displayName\": \"Production Policy - XSS allowed\",\n                            \"description\": \"Production-ready policy - XSS allowed\",\n                            \"contents\": \"{{github_gitops_root}}/v2/nap-policy-xss-allowed.json\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Update TLS certificates",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var respData = JSON.parse(responseBody);",
											"",
											"tests[\"configUid is: \" +respData.configUid] = respData.configUid;",
											"",
											"pm.collectionVariables.set('configUid',respData.configUid);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"synctime\": 0,\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ],\n            \"certificates\": [\n                {\n                    \"type\": \"certificate\",\n                    \"name\": \"test_cert\",\n                    \"contents\": \"{{github_gitops_root}}/v2/www2.online-boutique.local.crt\"\n                },\n                {\n                    \"type\": \"key\",\n                    \"name\": \"test_key\",\n                    \"contents\": \"{{github_gitops_root}}/v2/www2.online-boutique.local.key\"\n                }\n            ]\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Disable NGINX App Protect WAF",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var respData = JSON.parse(responseBody);",
											"",
											"tests[\"configUid is: \" +respData.configUid] = respData.configUid;",
											"",
											"pm.collectionVariables.set('configUid',respData.configUid);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"synctime\": 0,\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ]\n        }\n    },\n    \"declaration\": {\n        \"http\": {\n            \"servers\": [\n                {\n                    \"name\": \"Online boutique HTTPS\",\n                    \"names\": [\n                        \"www.online-boutique.lan\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"0.0.0.0:443\",\n                        \"http2\": true,\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/online_boutique_https_access_log\",\n                        \"error\": \"/var/log/nginx/online_boutique_https_error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"urimatch\": \"prefix\",\n                            \"upstream\": \"http://upstream_boutique\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get declaration status",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}/status",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}",
										"status"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get  declaration",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Delete  declaration",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "DELETE",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Declarative automation - GitOps",
					"item": [
						{
							"name": "NGINX App Protect WAF and GitOps",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var respData = JSON.parse(responseBody);",
											"",
											"tests[\"configUid is: \" +respData.configUid] = respData.configUid;",
											"",
											"pm.collectionVariables.set('configUid',respData.configUid);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"synctime\": 5,\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ],\n            \"certificates\": [\n                {\n                    \"type\": \"certificate\",\n                    \"name\": \"test_cert\",\n                    \"contents\": \"{{github_gitops_root}}/v2/www.online-boutique.local.crt\"\n                },\n                {\n                    \"type\": \"key\",\n                    \"name\": \"test_key\",\n                    \"contents\": \"{{github_gitops_root}}/v2/www.online-boutique.local.key\"\n                },\n                {\n                    \"type\": \"chain\",\n                    \"name\": \"test_chain\",\n                    \"contents\": \"{{github_gitops_root}}/v2/www.online-boutique.local.chain\"\n                }\n            ],\n            \"policies\": [\n                {\n                    \"type\": \"app_protect\",\n                    \"name\": \"production-policy\",\n                    \"active_tag\": \"gitops\",\n                    \"versions\": [\n                        {\n                            \"tag\": \"gitops\",\n                            \"displayName\": \"Production Policy - GitOps\",\n                            \"description\": \"This is a production-ready policy - Managed by GitOps\",\n                            \"contents\": \"{{github_gitops_root}}/v2/nap-policy-gitops.json\"\n                        }\n                    ]\n                }\n            ]\n        }\n    },\n    \"declaration\": {\n        \"http\": {\n            \"servers\": [\n                {\n                    \"name\": \"Online boutique HTTPS\",\n                    \"names\": [\n                        \"www.online-boutique.lan\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"0.0.0.0:443\",\n                        \"http2\": true,\n                        \"tls\": {\n                            \"certificate\": \"test_cert\",\n                            \"key\": \"test_key\",\n                            \"chain\": \"test_chain\",\n                            \"ciphers\": \"DEFAULT\",\n                            \"protocols\": [\n                                \"TLSv1.2\",\n                                \"TLSv1.3\"\n                            ]\n                        }\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/online_boutique_https_access_log\",\n                        \"error\": \"/var/log/nginx/online_boutique_https_error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"urimatch\": \"prefix\",\n                            \"upstream\": \"http://upstream_boutique\"\n                        }\n                    ],\n                    \"app_protect\": {\n                        \"enabled\": true,\n                        \"policy\": \"production-policy\",\n                        \"log\": {\n                            \"profile_name\": \"secops_dashboard\",\n                            \"enabled\": true,\n                            \"destination\": \"127.0.0.1:514\"\n                        }\n                    }\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"upstream_boutique\",\n                    \"origin\": [\n                        {\n                            \"server\": \"192.168.1.200:80\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get declaration status",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}/status",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}",
										"status"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get  declaration",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Delete  declaration",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "DELETE",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "CRUD automation",
					"item": [
						{
							"name": "Create initial NGINX configuration",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var respData = JSON.parse(responseBody);",
											"",
											"tests[\"configUid is: \" +respData.configUid] = respData.configUid;",
											"",
											"pm.collectionVariables.set('configUid',respData.configUid);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"synctime\": 0,\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ]\n        }\n    },\n    \"declaration\": {\n        \"http\": {\n            \"servers\": [\n                {\n                    \"name\": \"HTTP test application\",\n                    \"names\": [\n                        \"patched_server.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_log\",\n                        \"error\": \"/var/log/nginx/error_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"urimatch\": \"prefix\",\n                            \"upstream\": \"http://test_upstream\"\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config"
									]
								}
							},
							"response": []
						},
						{
							"name": "Update HTTP upstream",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var respData = JSON.parse(responseBody);",
											"",
											"tests[\"configUid is: \" +respData.configUid] = respData.configUid;",
											"",
											"pm.collectionVariables.set('configUid',respData.configUid);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"synctime\": 0,\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ]\n        }\n    },\n    \"declaration\": {\n        \"http\": {\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\"\n                        },\n                        {\n                            \"server\": \"10.0.0.3:80\"\n                        },\n                        {\n                            \"server\": \"10.0.0.4:80\"\n                        },\n                        {\n                            \"server\": \"10.0.0.5:80\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Modify and add HTTP upstream",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var respData = JSON.parse(responseBody);",
											"",
											"tests[\"configUid is: \" +respData.configUid] = respData.configUid;",
											"",
											"pm.collectionVariables.set('configUid',respData.configUid);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"synctime\": 0,\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ]\n        }\n    },\n    \"declaration\": {\n        \"http\": {\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:80\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:80\"\n                        }\n                    ]\n                },\n                {\n                    \"name\": \"test_upstream_added\",\n                    \"origin\": [\n                        {\n                            \"server\": \"192.168.1.1:80\"\n                        },\n                        {\n                            \"server\": \"192.168.1.2:80\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Modify and add HTTP server and upstream",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var respData = JSON.parse(responseBody);",
											"",
											"tests[\"configUid is: \" +respData.configUid] = respData.configUid;",
											"",
											"pm.collectionVariables.set('configUid',respData.configUid);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"synctime\": 0,\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ]\n        }\n    },\n    \"declaration\": {\n        \"http\": {\n            \"servers\": [\n                {\n                    \"name\": \"HTTP test application\",\n                    \"names\": [\n                        \"patched_server_v2.nginx.lab\"\n                    ],\n                    \"listen\": {\n                        \"address\": \"127.0.0.1:8080\"\n                    },\n                    \"log\": {\n                        \"access\": \"/var/log/nginx/access_v2_log\",\n                        \"error\": \"/var/log/nginx/error_v2_log\"\n                    },\n                    \"locations\": [\n                        {\n                            \"uri\": \"/\",\n                            \"urimatch\": \"prefix\",\n                            \"upstream\": \"http://test_upstream_added\"\n                        }\n                    ]\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream_added\",\n                    \"origin\": [\n                        {\n                            \"server\": \"192.168.1.100:80\",\n                            \"weight\": 5,\n                            \"max_fails\": 2,\n                            \"fail_timeout\": \"30s\",\n                            \"max_conns\": 3,\n                            \"slow_start\": \"30s\"\n                        },\n                        {\n                            \"server\": \"192.168.1.101:80\"\n                        },\n                        {\n                            \"server\": \"192.168.1.102:80\"\n                        },\n                        {\n                            \"server\": \"192.168.1.103:80\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Remove HTTP server and upstream",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var respData = JSON.parse(responseBody);",
											"",
											"tests[\"configUid is: \" +respData.configUid] = respData.configUid;",
											"",
											"pm.collectionVariables.set('configUid',respData.configUid);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"synctime\": 0,\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ]\n        }\n    },\n    \"declaration\": {\n        \"http\": {\n            \"servers\": [\n                {\n                    \"name\": \"HTTP test application\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"test_upstream_added\"\n                }\n            ]\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Modify Stream server and upstream",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var respData = JSON.parse(responseBody);",
											"",
											"tests[\"configUid is: \" +respData.configUid] = respData.configUid;",
											"",
											"pm.collectionVariables.set('configUid',respData.configUid);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"synctime\": 0,\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ]\n        }\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"name\": \"sample_layer4_service\",\n                    \"listen\": {\n                        \"address\": \"10053\",\n                        \"protocol\": \"tcp\"\n                    },\n                    \"upstream\": \"l4_upstream\",\n                    \"snippet\": \"http://acme.gitlab.local/test.snippet.server.l4.txt\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"l4_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"10.0.0.1:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.2:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.3:53\"\n                        },\n                        {\n                            \"server\": \"10.0.0.4:53\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Add stream server and upstream",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var respData = JSON.parse(responseBody);",
											"",
											"tests[\"configUid is: \" +respData.configUid] = respData.configUid;",
											"",
											"pm.collectionVariables.set('configUid',respData.configUid);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"synctime\": 0,\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ]\n        }\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"name\": \"new_tcp_service\",\n                    \"listen\": {\n                        \"address\": \"5432\",\n                        \"protocol\": \"tcp\"\n                    },\n                    \"upstream\": \"tcp_5432_upstream\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"tcp_5432_upstream\",\n                    \"origin\": [\n                        {\n                            \"server\": \"172.16.10.1:5432\"\n                        },\n                        {\n                            \"server\": \"172.16.10.1:5432\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Remove stream server and upstream",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var respData = JSON.parse(responseBody);",
											"",
											"tests[\"configUid is: \" +respData.configUid] = respData.configUid;",
											"",
											"pm.collectionVariables.set('configUid',respData.configUid);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"synctime\": 0,\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ]\n        }\n    },\n    \"declaration\": {\n        \"layer4\": {\n            \"servers\": [\n                {\n                    \"name\": \"new_tcp_service\"\n                }\n            ],\n            \"upstreams\": [\n                {\n                    \"name\": \"tcp_5432_upstream\"\n                }\n            ]\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get declaration status",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}/status",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}",
										"status"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get  declaration",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Delete  declaration",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "DELETE",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Erase configuration",
					"item": [
						{
							"name": "Clean NGINX configuration",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var respData = JSON.parse(responseBody);",
											"",
											"tests[\"configUid is: \" +respData.configUid] = respData.configUid;",
											"",
											"pm.collectionVariables.set('configUid',respData.configUid);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"output\": {\n        \"type\": \"nms\",\n        \"nms\": {\n            \"url\": \"{{nim_host}}\",\n            \"username\": \"{{nim_username}}\",\n            \"password\": \"{{nim_password}}\",\n            \"instancegroup\": \"{{nim_instancegroup}}\",\n            \"synctime\": 0,\n            \"modules\": [\n                \"ngx_http_app_protect_module\",\n                \"ngx_http_js_module\",\n                \"ngx_stream_js_module\"\n            ]\n        }\n    },\n    \"declaration\": {\n   \n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config"
									]
								}
							},
							"response": []
						},
						{
							"name": "Delete  declaration",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "DELETE",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://{{ncg_host}}:{{ncg_port}}/v2/config/{{configUid}}",
									"protocol": "http",
									"host": [
										"{{ncg_host}}"
									],
									"port": "{{ncg_port}}",
									"path": [
										"v2",
										"config",
										"{{configUid}}"
									]
								}
							},
							"response": []
						}
					]
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "ncg_host",
			"value": "127.0.0.1",
			"type": "default"
		},
		{
			"key": "ncg_port",
			"value": "5000",
			"type": "default"
		},
		{
			"key": "github_root",
			"value": "https://raw.githubusercontent.com/fabriziofiorucci/NGINX-Config-Generator/main/contrib/sample-source-of-truth/configs/",
			"type": "string"
		},
		{
			"key": "configUid",
			"value": ""
		},
		{
			"key": "nim_host",
			"value": "https://ubuntu.ff.lan",
			"type": "string"
		},
		{
			"key": "nim_username",
			"value": "admin",
			"type": "string"
		},
		{
			"key": "nim_password",
			"value": "admin",
			"type": "string"
		},
		{
			"key": "nim_instancegroup",
			"value": "declarativeAPITest",
			"type": "string"
		},
		{
			"key": "nim_synctime",
			"value": "10",
			"type": "string"
		},
		{
			"key": "github_gitops_root",
			"value": "https://raw.githubusercontent.com/fabriziofiorucci/NGINX-Declarative-API/main/contrib/gitops-examples",
			"type": "string"
		}
	]
}