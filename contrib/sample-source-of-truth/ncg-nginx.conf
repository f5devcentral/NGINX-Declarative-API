server {
        listen 80;
        server_name acme.gitlab.local;

        access_log /var/log/nginx/acme.gitlab.local_access.log;
        error_log /var/log/nginx/acme.gitlab.local_error.log;

        location /testpolicy.nap {
                return 200 '{"policy":{"applicationLanguage":"utf-8","blocking-settings":{"evasions":[{"description":"Apache whitespace","enabled":true},{"description":"Bad unescape","enabled":true},
{"description":"Bare byte decoding","enabled":true},{"description":"Directory traversals","enabled":true},{"description":"IIS Unicode codepoints","enabled":true},{"description":"IIS backslashes","ena
bled":true},{"description":"Multiple decoding","enabled":true,"maxDecodingPasses":2}],"http-protocols":[{"description":"Header name with no header value","enabled":true}],"violations":[{"alarm":true,
"block":false,"name":"VIOL_DATA_GUARD"},{"alarm":true,"block":true,"name":"VIOL_HTTP_PROTOCOL"},{"alarm":true,"block":true,"name":"VIOL_FILETYPE"},{"alarm":true,"block":true,"name":"VIOL_HEADER_METAC
HAR"},{"alarm":true,"block":true,"name":"VIOL_EVASION"}]},"data-guard":{"creditCardNumbers":true,"enabled":true,"enforcementMode":"ignore-urls-in-list","enforcementUrls":[],"maskData":true,"usSocialS
ecurityNumbers":true},"enforcementMode":"blocking","filetypes":[{"allowed":true,"checkPostDataLength":false,"checkQueryStringLength":true,"checkRequestLength":false,"checkUrlLength":true,"name":"*","
postDataLength":4096,"queryStringLength":2048,"requestLength":8192,"responseCheck":false,"type":"wildcard","urlLength":2048},{"allowed":false,"name":"bat"}],"general":{"trustXff":true},"name":"nginx-
policy","signature-sets":[{"alarm":true,"block":true,"name":"Command Execution Signatures"},{"alarm":true,"block":true,"name":"Cross Site Scripting Signatures"},{"alarm":true,"block":true,"name":"SQL
 Injection Signatures"}],"signature-settings":{"minimumAccuracyForAutoAddedSignatures":"low"},"template":{"name":"POLICY_TEMPLATE_NGINX_BASE"}}}';
        }

        location /test.key {
                return 200 '-----BEGIN PRIVATE KEY-----
MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQDHYTOnP9LY7DiH
zPQNt7AtiPhpoO8OQVJnRgfTLCUpAYKT4+s/dBpVu8BkLJwQgjL5KTt9xFeNYjpA
t27u257ebnTf3ZR+H8IN+vkIItsks51JzUAjQQyDHEK2qK/SbZ0V9N2ronL0cSRQ
oqP1/+tx9QBnQyYUlYi0FfY1emumTNS+PXEFKcx0SWTg3rtrB7ItRgZ/+YEPliE7
w2cB3eDdhTR3/ciClVAYt1E1gY0BP1ZsrxVK3gG8nrSLJRv3lFBRNsUGitVioC1A
ZPbYLM66qneZrnJwyX7s13az/rFOmnf2P3l9e7SYZ6pJy4J306LueSozlrTsIN8f
ZMo3fZwDAgMBAAECggEAAIcehR0DUFVZkZnuXSw2aFum3jFbg20HB6vdtX2C08eF
1Kab8fC2E7I2Q78eHMgrPeVnRirrUlXvbxb8KGiZH5oZp8X0GZ1SajDEN0H9ze/s
AJf8sWZK2DbBtj4GNiUk4zv3Pys0auoYluNkInJQl6X4eKZB0V0Xmnx4Biz3FUUU
9bRTe3OELV045LRKwydg9afBvPpFHBGHqPqDZmLyzMeMB5GVbA8Gv5Q8A/zXWmrz
IQ4AYYyU5vVW+0rkCQEYnGW9BSbb0zwzkuPJkSQ88s8utOdf1NR8fAVGgk8WTvWj
QVyJW5zJw6K9lKL6K/xT9J9FbYjPXVCwmch30yJOYQKBgQDR76jdFxs16J1twSvt
BAEc39QBy0O6cPIbKWXX8MED0uGJlaBQIa9YGhKyFaNRF2UMBXXuYVYuSdkoYq0l
5Pgvbh5V1B1UaTyXm+Q9AqalszRAnSuqJs+lW2ChNHH4YB9g+4+dYfqDn1gSRY32
oeYkWNZCEGOG4ACmI2WeO0ZIrwKBgQDzIJLTsBrw2We1o39WvFJHhQzD4MSjiHz/
TRe/UWfDZPuO6fqpG5z3nOhZElPBnFKJ56PzFazlICMqvjhDvmNJfoRwcO8rua8o
zusoctnMyS1O8LR09mdYOuXrcDWjfyA7edpbYERLf3Ard/eIfJ4E2wHb7mXLDx1l
QvpcGulO7QKBgDH3+Fp/eHORZX9NPlZQ4K7tu7mdlwZWgdnjNaF7ZYWyeQpVee34
xpKSyiZnLhNMHToKRrKxqmCkJTMOoaXmZQhtDn1hWoXP8qMncODws5e3GtXSUyVR
zZTPNiXIpOP4hR+BYQKV4pnXoI/gzFSK3ouCNaVN31KoGJ9yx2otM6JzAoGAL6bp
wD3a+evSjOJPugNNKSFlwBqUz+yXez5z8haVfNGVEIzBiVWVLV7+lz6lVeQ6tTbG
hoVwDrR+0AjaZESzlxsKADPSXMKXFyt/Ib1o/N9NVxSMegQ1ezCIEd47VSE8gwu+
BXzXxehjZtGrnX+3RQJb2exe3S7INymqglTv930CgYBJl+a/Dst8NbVQ/Dznz/wV
OH8JPCNKNDBmVKvTU3bC/XAo+Bn6kg+l6js69FFeXr/8iG/nlMoPA9gOfqopfgp3
ZSdQ5FS+BOdtT+ObZq0erlIJY4uogkuDWci/3ZxLdbsPRxIKg82gXEOC7WgoulQT
WWhUJRxjItlzyGlxxooijA==
-----END PRIVATE KEY-----
';
        }

        location /test.crt {
                return 200 '-----BEGIN CERTIFICATE-----
MIIDRTCCAi0CFCAEP0e7Sp82QntNqdVNApwoUNx2MA0GCSqGSIb3DQEBCwUAMF8x
CzAJBgNVBAYTAklUMQ4wDAYDVQQIDAVNaWxhbjEOMAwGA1UEBwwFTWlsYW4xFTAT
BgNVBAoMDFRlc3QgQ29tcGFueTEZMBcGA1UEAwwQdGVzdC5jb21wYW55LmxhYjAe
Fw0yMjA1MTYwNzU4NTdaFw0zMjA1MTMwNzU4NTdaMF8xCzAJBgNVBAYTAklUMQ4w
DAYDVQQIDAVNaWxhbjEOMAwGA1UEBwwFTWlsYW4xFTATBgNVBAoMDFRlc3QgQ29t
cGFueTEZMBcGA1UEAwwQdGVzdC5jb21wYW55LmxhYjCCASIwDQYJKoZIhvcNAQEB
BQADggEPADCCAQoCggEBAMdhM6c/0tjsOIfM9A23sC2I+Gmg7w5BUmdGB9MsJSkB
gpPj6z90GlW7wGQsnBCCMvkpO33EV41iOkC3bu7bnt5udN/dlH4fwg36+Qgi2ySz
nUnNQCNBDIMcQraor9JtnRX03auicvRxJFCio/X/63H1AGdDJhSViLQV9jV6a6ZM
1L49cQUpzHRJZODeu2sHsi1GBn/5gQ+WITvDZwHd4N2FNHf9yIKVUBi3UTWBjQE/
VmyvFUreAbyetIslG/eUUFE2xQaK1WKgLUBk9tgszrqqd5mucnDJfuzXdrP+sU6a
d/Y/eX17tJhnqknLgnfTou55KjOWtOwg3x9kyjd9nAMCAwEAATANBgkqhkiG9w0B
AQsFAAOCAQEAxrcZizdt/L1Z5XBq6GGcY3Ro0tdGctfGgClv4oG5ShNABdaA2/CV
VA4LkdorXWOaAcFilipPe7KFaWHgq0gt4xKx/9d9VHqNNck+NY4SwG43kZ32Ad4C
gRZ04EasX7hnp8mwjZKCAHZJF+i+t/lHRNhACS1F0zrBc++sTzNQ+WgNuDo3v9i2
ChgPQlKAss4zs54a5FbNL2dYbj4dkixI430mMyux8HbOQasVoCVzWqkKkoQ7nduH
EPkYM3G/rUtPg8NUMUVydt1Unydow8rxXb6bC6+y1PsakXxRumtdYgl3wQkIj+FP
1TX0IOj+7MfttqgqzaaRo9WK5cwie0eDfA==
-----END CERTIFICATE-----
';
        }

        location /test.chain {
                return 200 '-----BEGIN CERTIFICATE-----
MIIDRTCCAi0CFCAEP0e7Sp82QntNqdVNApwoUNx2MA0GCSqGSIb3DQEBCwUAMF8x
CzAJBgNVBAYTAklUMQ4wDAYDVQQIDAVNaWxhbjEOMAwGA1UEBwwFTWlsYW4xFTAT
BgNVBAoMDFRlc3QgQ29tcGFueTEZMBcGA1UEAwwQdGVzdC5jb21wYW55LmxhYjAe
Fw0yMjA1MTYwNzU4NTdaFw0zMjA1MTMwNzU4NTdaMF8xCzAJBgNVBAYTAklUMQ4w
DAYDVQQIDAVNaWxhbjEOMAwGA1UEBwwFTWlsYW4xFTATBgNVBAoMDFRlc3QgQ29t
cGFueTEZMBcGA1UEAwwQdGVzdC5jb21wYW55LmxhYjCCASIwDQYJKoZIhvcNAQEB
BQADggEPADCCAQoCggEBAMdhM6c/0tjsOIfM9A23sC2I+Gmg7w5BUmdGB9MsJSkB
gpPj6z90GlW7wGQsnBCCMvkpO33EV41iOkC3bu7bnt5udN/dlH4fwg36+Qgi2ySz
nUnNQCNBDIMcQraor9JtnRX03auicvRxJFCio/X/63H1AGdDJhSViLQV9jV6a6ZM
1L49cQUpzHRJZODeu2sHsi1GBn/5gQ+WITvDZwHd4N2FNHf9yIKVUBi3UTWBjQE/
VmyvFUreAbyetIslG/eUUFE2xQaK1WKgLUBk9tgszrqqd5mucnDJfuzXdrP+sU6a
d/Y/eX17tJhnqknLgnfTou55KjOWtOwg3x9kyjd9nAMCAwEAATANBgkqhkiG9w0B
AQsFAAOCAQEAxrcZizdt/L1Z5XBq6GGcY3Ro0tdGctfGgClv4oG5ShNABdaA2/CV
VA4LkdorXWOaAcFilipPe7KFaWHgq0gt4xKx/9d9VHqNNck+NY4SwG43kZ32Ad4C
gRZ04EasX7hnp8mwjZKCAHZJF+i+t/lHRNhACS1F0zrBc++sTzNQ+WgNuDo3v9i2
ChgPQlKAss4zs54a5FbNL2dYbj4dkixI430mMyux8HbOQasVoCVzWqkKkoQ7nduH
EPkYM3G/rUtPg8NUMUVydt1Unydow8rxXb6bC6+y1PsakXxRumtdYgl3wQkIj+FP
1TX0IOj+7MfttqgqzaaRo9WK5cwie0eDfA==
-----END CERTIFICATE-----
';
        }

        location /test.snippet.http {
                return 200 'IyBUaGlzIGlzIGEgSFRUUCBzbmlwcGV0IGNvbW1lbnQK';
        }

        location /test.snippet.upstream {
                return 200 'IyBUaGlzIGlzIGEgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==';
        }

        location /test.snippet.location {
                return 200 'IyBUaGlzIGlzIGEgbG9jYXRpb24gc25pcHBldCBjb21tZW50Cg==';
        }

        location /test.snippet.server {
                return 200 'IyBUaGlzIGlzIGEgc2VydmVyIHNuaXBwZXQgY29tbWVudAo=';
        }

        location /test.snippet.server.l4 {
                return 200 'IyBUaGlzIGlzIGEgbDQgdXBzdHJlYW0gc25pcHBldCBjb21tZW50Cg==';
        }
}
